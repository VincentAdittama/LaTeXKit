# MISSION: PLAN (Phase 2 of 6)

## VISION
Initialize the project structure, metadata, and execution plan. This phase transforms a vague idea into a concrete roadmap (`plan.md`) that guides the AI agent through Research, Outline, Draft, and Convert phases.

## CONTEXT
- **Input**: User arguments or interactive input defining the assignment.
- **Output**: Populated `generated_work/plan.md`.
- **Goal**: Establish a clear "Contract" for the project.

## INPUT
```text
$ARGUMENTS
```

## MISSION STEPS

1.  **DETECT PROJECT State**
    - Execute `PROJECT_ROOT="$(git rev-parse --show-toplevel)" && bash "$PROJECT_ROOT/.latexkit/scripts/bash/check_state.sh"`
    - If output is `ACTIVE_PROJECT=`, STOP and instruct user: "Please run \`latexkit new\` first."
    - If output is `ACTIVE_PROJECT=...`, proceed.

2.  **GATHER CONTEXT**
    - **CRITICAL**: Check if `assignment_info/` directory exists.
    - If it exists, you MUST:
        - Execute `ls -F assignment_info/` to see available files.
        - Read content of relevant files (e.g., `cat assignment_info/brief.md assignment_info/info.md` or similar).
    - **Integration**: Use this gathered information to populate `plan.md` in the next step. prioritizing it over generic defaults.

3.  **EXTRACT REQUIREMENTS (The Brief)**
    - Analyze user input ($ARGUMENTS) to populate `plan.md`.
    - Extract:
        - **Project Name/Description**
        - **Document Type** (Essay, Report, Thesis, etc.)
        - **Language**: `Indonesian` (default) or `English`.
        - **Team Info**: If missing, use `[TO FILL: Team Info]`. **DO NOT ASK USER.**
        - **Deadline**: If missing, use `[TO FILL: Deadline]`. **DO NOT ASK USER.**

4.  **EXECUTE: Create/Update Plan**
    - File: `generated_work/plan.md`
    - Action: Create if missing, Update if exists (smart merge, verify conflict).
    - Format: Use standard `latexkit.plan` structure (Overview, Requirements, Key Topics).

5.  **EXECUTE: Verify Structure**
    - Ensure `latex_source/`, `generated_work/`, `assignment_info/`, `zotero_export/` exist.
    - If Academic: Remind user to export Zotero library to `zotero_export/`.

6.  **REPORT**
    - Summary: "Plan Initialized for [Project Name]".
    - **Warnings**: List any `[TO FILL]` items that require user attention.
    - Next Step: "Recommended: \`latexkit research\` (Phase 3)".

## RULES
- **Main-Only**: We work in `documents/` directly. No branches.
- **Absolute Paths**: Always use absolute paths for file operations.
- **Non-Interactive**: **NEVER** ask clarifying questions. If information is missing, leave a `[TO FILL]` placeholder and proceed. We must produce the file in one shot.

