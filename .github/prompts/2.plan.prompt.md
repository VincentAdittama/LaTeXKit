# MISSION: PLAN (Phase 2 of 6)

## VISION
Initialize the project structure, metadata, and execution plan. This phase transforms a vague idea into a concrete roadmap (`plan.md`) that guides the AI agent through Research, Outline, Draft, and Convert phases.

## CONTEXT
- **Input**: User arguments or interactive input defining the assignment.
- **Output**: Populated `generated_work/plan.md` and initial project checklists.
- **Goal**: Establish a clear "Contract" for the project.

## INPUT
```text
$ARGUMENTS
```

## MISSION STEPS

1.  **DETECT PROJECT State**
    - Execute `source .latexkit/scripts/bash/common.sh && eval $(get_document_paths) && echo "ACTIVE_PROJECT=$ACTIVE_PROJECT"`
    - If no active project, STOP and instruct user: "Please run \`latexkit new\` first."

2.  **EXTRACT REQUIREMENTS (The Brief)**
    - Analyze user input ($ARGUMENTS) to populate `plan.md`.
    - Extract:
        - **Project Name/Description**
        - **Document Type** (Essay, Report, Thesis, etc.)
        - **Language**: `Indonesian` (default) or `English`. *Note: detailed planning can be in English, but this setting controls the final LaTeX output.*
        - **Team Info**: (MANDATORY) If group work, extract names, roles, IDs.
        - **Deadline**: If specified.

3.  **EXECUTE: Create/Update Plan**
    - File: `generated_work/plan.md`
    - Action: Create if missing, Update if exists (smart merge, verify conflict).
    - Format: Use standard `latexkit.plan` structure (Overview, Requirements, Key Topics).

4.  **EXECUTE: Initialize Checklists**
    - Copy `.latexkit/templates/checklists/latexkit.plan.md` to `checklists/`.
    - Customize with Document ID and Date.

5.  **EXECUTE: Verify Structure**
    - Ensure `latex_source/`, `generated_work/`, `assignment_info/`, `zotero_export/` exist.
    - If Academic: Remind user to export Zotero library to `zotero_export/`.

6.  **EXECUTE: Update Checklist**
    - Open `checklists/latexkit.plan.md`.
    - Mark completed items with `[x]`.

7.  **REPORT**
    - Summary: "Plan Initialized for [Project Name]".
    - Next Step: "Recommended: \`latexkit research\` (Phase 3)".

## RULES
- **Main-Only**: We work in `documents/` directly. No branches.
- **Absolute Paths**: Always use absolute paths for file operations.
- **User First**: If input is unclear, ask ONE clarifying question (max 3 times), then proceed with defaults.

